import{_ as A,a as H,b as N}from"./headSticker-XsKf4qe2.js";import{_ as V}from"./Index.vue_vue_type_script_setup_true_lang--7t1DGyJ.js";import{_ as S}from"./OrderDetailCard.vue_vue_type_style_index_0_lang-nUdwSXYN.js";import{d as G,a3 as L,s as R,r as _,v as j,q as k,i as q,w as u,o as m,a as e,h,c as v,t as F,b as p,l as i,m as g,aq as E}from"./index-llA4aS_m.js";import{b as P,d as W}from"./orders-F_VZiq1b.js";import"./BaseButton.vue_vue_type_style_index_0_lang-SNBCSjIp.js";import"./handleDate-UCcrZpx4.js";import"./formatTransform-8BW5CwT8.js";const z={class:"bg-neutral-dark user"},J={class:"banner"},K=e("img",{class:"banner__bg w-100 d-none d-lg-block",src:A,alt:"userBanner"},null,-1),M=e("img",{class:"banner__bg w-100 d-block d-lg-none",src:H,alt:"userBanner"},null,-1),Q={class:"banner__container container"},U={class:"banner__head d-flex flex-column flex-lg-row align-items-lg-center gap-3 gap-lg-4"},X=e("img",{src:N,alt:"headSticker"},null,-1),Y={key:0,class:"text-white fw-bold m-0"},Z={class:"container-lg pb-6 pb-lg-11"},ee={class:"py-6 py-lg-10"},te={class:"row gap-4 gap-lg-6 d-flex flex-column flex-lg-row w-100 m-auto"},se={class:"col-12 col-lg-6 col-xxl-6 p-0 h-100"},oe={key:0,class:"d-flex justify-content-between gap-3 pt-6"},ne={key:1,class:"d-flex justify-content-center gap-6 pt-6"},ae=["disabled"],le=e("span",{class:"ps-2"},"上一筆訂單",-1),re=["disabled"],ie=e("span",{class:"pe-2"},"下一筆訂單",-1),ce={class:"col-12 col-lg p-0 h-100"},we=G({__name:"Orders",setup(ue){const O=L(),{userInformation:y}=R(O),f=_(!1),w=_([]),s=_(null),n=_([]),b=_([]),x=j(()=>w.value.filter(o=>o.status===0));function C(){const o=Date.now(),t=7*60*60*1e3;let l=x.value.filter(r=>new Date(r.checkInDate).getTime()+t<o),c=w.value.filter(r=>r.status===-1),d=l.concat(c);b.value=d.sort((r,T)=>new Date(T.checkInDate).getTime()-new Date(r.checkInDate).getTime())}function I(){s.value=null;const o=Date.now(),t=7*60*60*1e3;n.value=x.value.filter(l=>new Date(l.checkInDate).getTime()+t>=o).sort((l,c)=>new Date(l.checkInDate).getTime()-new Date(c.checkInDate).getTime()),n.value.length!==0&&(s.value=n.value[0])}let a=0;function D(o){o==="prev"?a>0&&(a--,s.value=n.value[a]):a<n.value.length-1&&(a++,s.value=n.value[a])}function $(){E.fire({icon:"info",title:"取消預定",text:"確定要取消此房型的預訂嗎?",showCancelButton:!0,showConfirmButton:!0,cancelButtonText:"關閉視窗",confirmButtonText:"確定取消"}).then(o=>{if(o.isConfirmed){const t=s.value._id;W(t).then(()=>B())}})}async function B(){w.value=await P(),C(),I()}return B(),(o,t)=>{const l=k("router-link"),c=k("RouterLink"),d=k("font-awesome-icon");return m(),q(V,{"is-has-footer-decoration":""},{default:u(()=>[e("section",z,[e("div",J,[K,M,e("div",Q,[e("div",U,[X,h(y)?(m(),v("h1",Y," Hello，"+F(h(y).name),1)):p("",!0)])])]),e("div",Z,[e("nav",ee,[i(l,{to:"/user",class:"baseButton isStyleGhost px-4 py-3","active-class":"active"},{default:u(()=>[g(" 個人資料 ")]),_:1}),i(l,{to:"/user/orders",class:"baseButton isStyleGhost px-4 py-3","active-class":"active"},{default:u(()=>[g(" 我的訂單 ")]),_:1})]),e("main",te,[e("div",se,[i(S,{orderDetails:s.value?[s.value]:[]},{default:u(()=>[s.value?(m(),v("div",oe,[e("button",{class:"baseButton isStyleSecondary w-100",onClick:$}," 取消預定 "),i(c,{to:`/rooms/${s.value?s.value.roomId._id:null}`,class:"baseButton isStylePrimary w-100"},{default:u(()=>[g(" 查看詳情 ")]),_:1},8,["to"])])):p("",!0),n.value.length>1?(m(),v("div",ne,[e("button",{disabled:h(a)==0,class:"baseButton isStyleText",onClick:t[0]||(t[0]=r=>D("prev"))},[i(d,{icon:["fas","chevron-left"]}),le],8,ae),e("button",{disabled:h(a)===n.value.length-1,class:"baseButton isStyleText",onClick:t[1]||(t[1]=r=>D("next"))},[ie,i(d,{icon:["fas","chevron-right"]})],8,re)])):p("",!0)]),_:1},8,["orderDetails"])]),e("div",ce,[i(S,{isHistory:!0,orderDetails:b.value,isShowAll:f.value},{default:u(()=>[b.value.length>3&&!f.value?(m(),v("button",{key:0,class:"baseButton isStyleSecondary w-100",onClick:t[2]||(t[2]=r=>f.value=!f.value)},[g(" 查看更多"),i(d,{class:"ps-1",icon:"chevron-down"})])):p("",!0)]),_:1},8,["orderDetails","isShowAll"])])])])])]),_:1})}}});export{we as default};
